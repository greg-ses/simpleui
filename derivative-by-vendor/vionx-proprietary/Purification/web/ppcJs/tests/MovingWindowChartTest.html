<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>LED Stack test</title>
    <link rel="stylesheet" type="text/css" href="../../dojo-toolkit/dojo/resources/dojo.css" />
    <link rel="stylesheet" type="text/css" href="../../dojo-toolkit/dijit/themes/soria/soria.css" />
    <link rel="stylesheet" type="text/css" href="../panel/movingWindowChart/css/movingWindowChart.css" />

    <script type="text/javascript">
        // djConfig must be set before any dojo scripts are loaded
        var djConfig = {
            isDebug: false,
            parseOnLoad: true,
            modulePaths: { 'ppcJs': '../../ppcJs' }
        };
    </script>

    <script type="text/javascript" src="../../dojo-toolkit/dojo/dojo.js"></script>
    <script type="text/javascript">
        dojo.provide("ppcJs.tests.MovingWindowChartTestHTML");
        dojo.require("dojo.parser");
        dojo.require("doh.runner");
        dojo.require("dojo.robot");
        dojo.require("ppcJs.panel.MovingWindowChart");
        dojo.require("ppcJs.tests.ParamControlTestUtilities");

        var perActionDelay = 600;
        var perActionPause = 500;
        var assertPause = 10 * perActionPause;
        var testCaseTimeout = 80 * perActionPause;

        dojo.addOnLoad(function () {
            doh.register("ppcJs.tests.MovingWindowChartTest", [
                    {
                        name: "CreateMovingWindowChart",
                        timeout: testCaseTimeout,

                        setUp: function () {
                            var sutContainer = dojo.byId('sutContainer');
                            sutContainer.innerHTML = "";
                        },

                        runTest: function () {
                            var d = new doh.Deferred();

                            var sutContainer = dojo.byId("sutContainer");

                            var sut = new ppcJs.panel.MovingWindowChart();
                            dojo.place(sut.domNode, "sutContainer");

                            var hostUrl = window.location.host;
                            var cgiPath = 'cgi-bin/cgicmd';
                            var queryString = 'CGI=sqreader';
                            var baseAjaxReq = window.location.protocol + '//' + hostUrl + '/' + cgiPath + '?' + queryString;
                            sut.load(baseAjaxReq);

                            var queryObj = { DATA_DB: 'System', DATA_SET: 'Batt_AH' };
                            sut.selectChart(queryObj, 300, 'MovingWindowChartTest');

                            doh.robot.mouseMoveAt(dojo.byId('sutContainer'), perActionDelay, perActionPause);

                            doh.robot.sequence(function () {
                                d.callback(true);

                            }, assertPause);

                            return d;
                        }
                    }
                ]);
            //Execute D.O.H. in this remote file.
            doh.run();
        });
    </script>
</head>
<body class="soria">
    <!-- place to insert sut. -->
    <div id="sutContainer" style="width: 300px">
    </div>
    <div id="mouseOutArea" style="width: 300px; height: 100px">
        <br />
    </div>
</body>
</html>
