<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>ScriptRunner test</title>
    <link rel="stylesheet" type="text/css" href="../../dojo-toolkit/dojo/resources/dojo.css" />
    <link rel="stylesheet" type="text/css" href="../../dojo-toolkit/dijit/themes/soria/soria.css" />
    <link rel="stylesheet" type="text/css" href="../control/scriptRunner/css/scriptRunner.css" />

    <script type="text/javascript">
        // djConfig must be set before any dojo scripts are loaded
        var djConfig = {
            isDebug: false,
            parseOnLoad: true,
            modulePaths: { 'ppcJs': '../../ppcJs' }
        };
    </script>

    <script type="text/javascript" src="../../dojo-toolkit/dojo/dojo.js"></script>
    <script type="text/javascript">
        dojo.provide("ppcJs.tests.ScriptRunnerTestHTML");
        dojo.require("dojo.parser");
        dojo.require("doh.runner");
        dojo.require('ppcJs.utilities.AccessControl');
        dojo.require('ppcJs.utilities.Store');
        dojo.require('ppcJs.control.ScriptRunner');
        dojo.require('ppcJs.control.scriptRunner.srDto');
        dojo.require('ppcJs.control._control._cDto');
        dojo.require('ppcJs.script.State');
        dojo.require('ppcJs.Enum');

        dojo.addOnLoad(function () {
            doh.register("ppcJs.tests.ScriptRunnerTest", [
                    function testCreateScriptRunner(t) {
                        var sutContainer = dojo.byId("sutContainer");
                        var sut = new ppcJs.control.ScriptRunner();
                        dojo.place(sut.domNode, "sutContainer");

                        // ajax request URL, less command and parameters
                        var serverProcess = 'AutoCycleCmd';
                        var hostUrl = window.location.host;
                        var handlerPath = '../cgi/cgicmd';
                        var urlVal = window.location.protocol + '//' + hostUrl + '/' + handlerPath;
                        var urlInfo = ppcJs.utilities.Store.getUrlInfo(urlVal, serverProcess);
                        var resourceId = 'resourceId0';
                        var dto = new ppcJs.control._control._cDto.Ctor(urlInfo, [ppcJs.utilities.AccessControl.Task.SystemControl], resourceId);
                        dojo.mixin(dto, { resourceName: 'resourceName0' });
                        sut.configure(dto);

                        var activeFileName = 'activeFile.xml';
                        var scriptState = new ppcJs.script.State(activeFileName, 'id0', ppcJs.Enum.PlayBackState.Stopped, resourceId);
                        var update = new ppcJs.control.scriptRunner.srDto.Update(scriptState, ppcJs.Enum.Error.Warn, 'mode1', 'submode2');
                        sut.update(update);
                        var fileList = ['file0.xml', activeFileName, 'file1.xml'];
                        sut.setFileList(fileList);
                        sut.setViewState(ppcJs.Enum.View);
                        sut.select();

                        t.assertTrue(true);
                    }

                ]);
            //Execute D.O.H. in this remote file.
            doh.run();
        });
    </script>
</head>
<body class="soria">
    <!-- place to insert sut. -->
    <div id="sutContainer" style="width: 300px">
    </div>
    <div id="mouseOutArea" style="width: 300px; height: 100px">
        <br />
    </div>
</body>
</html>
